webpackJsonp([0],[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}n(1),n(2);var i=n(4),o=r(i),a=n(5),s=r(a),u=n(6),l=r(u),c=new o.default,h=new s.default(document.querySelector("canvas").getContext("2d")),f=new l.default(c,h,40);f.load(),f.render(),f.subscribe(),window.field=f},,function(t,e){},,function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t){console.log(t.length,t.map(function(t){var e=v(t.coords,2);return"("+e[0]+", "+e[1]+")"}).join("-"))}function o(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length-1;n+=1)if(!t[n].isEqual(e[t.length-n-2]))return!1;return!0}function a(t){for(var e=t.slice(),n=null,r=0;r<t.length;r+=1)if(null!==(n=e[r]))for(var i=r+1;i<t.length;i+=1)null!==e[i]&&o(n,e[i])&&(e[i]=null);return e.filter(function(t){return null!==t})}function s(t){var e=v(t,2),n=e[0],r=e[1],i=v(n.coords,2),o=i[0],a=i[1],s=v(r.coords,2),u=s[0],l=s[1];return o!==u&&a!==l}function u(t){for(var e=[],n=null,r=1;r<t.length;r+=1)n=[t[r-1],t[r]],s(n)&&e.push(n);return n=[t[t.length-1],t[0]],s(n)&&e.push(n),e}function l(t,e){var n=v(t,2),r=n[0],i=n[1],o=v(e,2),a=o[0],s=o[1],u=v(r.coords,2),l=u[0],c=u[1],h=v(i.coords,2),f=h[0],d=h[1],y=v(a.coords,2),w=y[0],g=y[1],p=v(s.coords,2),m=p[0],k=p[1];return l===w&&d===g&&f===m&&c===k||l===m&&d===k&&f===w&&c===g}function c(t){for(var e=u(t),n=0;n<e.length;n+=1)for(var r=n+1;r<e.length;r+=1)if(l(e[n],e[r]))return!0;return!1}function h(t){return t.filter(function(t){return!c(t)})}function f(t){var e=[];return t.forEach(function(t){t&&(t[0]instanceof y?e.push(t):e=e.concat(f(t)))}),e}Object.defineProperty(e,"__esModule",{value:!0});var v=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),d=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),y=function(){function t(e,n){r(this,t),this.coords=e,this.color=n}return d(t,[{key:"isEqual",value:function(t){return this.coords[0]===t.coords[0]&&this.coords[1]===t.coords[1]}},{key:"inPath",value:function(t){var e=this;return t.some(function(t){return e.isEqual(t)})}}]),t}(),w=function(){function t(){r(this,t),this.reset()}return d(t,[{key:"reset",value:function(){this.spots=[],this.zones={red:[],blue:[]}}},{key:"preset",value:function(t){this.spots=t||[]}},{key:"placeDot",value:function(t,e){var n=v(t,2),r=n[0],i=n[1];return Array.isArray(this.spots[r])||(this.spots[r]=[]),this.spots[r][i]=e,new y([r,i],e)}},{key:"getDot",value:function(t){var e=v(t,2),n=e[0],r=e[1];if(!Array.isArray(this.spots[n]))return null;var i=this.spots[n][r];return i?new y([n,r],i):null}},{key:"getAllDots",value:function(){var t=[];return this.forEachDot(function(e,n){var r=v(e,2),i=r[0],o=r[1];t.push(new y([i,o],n))}),t}},{key:"getAdjacentDots",value:function(t){for(var e=v(t.coords,2),n=e[0],r=e[1],i=t.color,o=[],a=null,s=n-1;s<=n+1;s+=1)for(var u=r-1;u<=r+1;u+=1)s===n&&u===r||(a=this.getDot([s,u]))&&a.color===i&&o.push(a);return o}},{key:"countDots",value:function(){var t={red:0,blue:0};return this.forEachDot(function(e,n){t[n]+=1}),t}},{key:"addDotToZones",value:function(t){var e=this,n=this.getAdjacentDots(t);if(!(n.length<2)){var r=n.map(function(n){return e.makePaths([n],t)}),o=this.zones[t.color];h(a(f(r))).forEach(function(t){o.push(t),i(t)})}}},{key:"makePaths",value:function(t,e){var n=this,r=[];return this.getAdjacentDots(t[t.length-1]).forEach(function(i){if(i.isEqual(e))return void(t.length>2&&r.push(t.concat(e)));i.inPath(t)||r.push(n.makePaths(t.concat(i),e))}),r.length?r:null}},{key:"forEachDot",value:function(t){this.spots.forEach(function(e,n){Array.isArray(e)&&e.forEach(function(e,r){e&&t([n,r],e)})})}}]),t}();e.default=w},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&s.return&&s.return()}finally{if(i)throw o}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(){function t(e){r(this,t),this.ctx=e,this.colorCodes={white:[255,255,255],red:[192,64,0],blue:[0,96,192]}}return o(t,[{key:"getColorCode",value:function(t,e){return"rgba("+this.colorCodes[t].concat(e).join(",")+")"}},{key:"listenTo",value:function(t,e){this.ctx.canvas.addEventListener(t,e)}},{key:"getDimensions",value:function(){return[this.ctx.canvas.width,this.ctx.canvas.height]}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}},{key:"drawLine",value:function(t,e,n,r,o){var a=i(r,2),s=a[0],u=a[1],l=i(o,2),c=l[0],h=l[1];this.ctx.setLineDash(e?[2,4]:[]),this.ctx.beginPath(),this.ctx.moveTo(s,u),this.ctx.lineTo(c,h),this.ctx.lineWidth=n,this.ctx.strokeStyle=t,this.ctx.stroke()}},{key:"drawStrokeRect",value:function(t,e){var n=i(t,2),r=n[0],o=n[1],a=i(e,2),s=a[0],u=a[1];this.ctx.setLineDash([]),this.ctx.strokeRect(r,o,s-r,u-o)}},{key:"drawDot",value:function(t,e,n){var r=i(n,2),o=r[0],a=r[1];this.ctx.beginPath(),this.ctx.arc(o,a,e,0,2*Math.PI,!1),this.ctx.fillStyle=t,this.ctx.fill()}},{key:"drawDotCoords",value:function(t,e,n,r){var o=i(n,2),a=o[0],s=o[1],u=i(r,2),l=u[0],c=u[1];this.ctx.fillStyle=t,this.ctx.fillText("("+l+", "+c+")",a+e,s-e)}}]),t}();e.default=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=function(){function t(e,n,i){r(this,t),this.matrix=e,this.view=n,this.cellSize=i,this.minCellSize=10,this.maxCellSize=100,this.nextPlayer="red"}return i(t,[{key:"load",value:function(){this.matrix.preset(JSON.parse(localStorage.getItem("matrix")));var t=this.matrix.countDots();this.nextPlayer=t.red>t.blue?"blue":"red"}},{key:"save",value:function(){localStorage.setItem("matrix",JSON.stringify(this.matrix.spots))}},{key:"render",value:function(){this.view.clear(),this.drawGrid(),this.drawDots(),this.drawZones()}},{key:"subscribe",value:function(){document.addEventListener("keydown",this.clearOnKeyDown.bind(this)),this.view.listenTo("wheel",this.zoomOnScroll.bind(this)),this.view.listenTo("mousemove",this.drawDotPlaceholderOnMouseMove.bind(this)),this.view.listenTo("click",this.placeDotOnClick.bind(this))}},{key:"drawGrid",value:function(){var t=this,e=this.view.getDimensions(),n=this.view.getColorCode("white",.6);[0,1].forEach(function(r){for(var i=e[r],o=Math.floor(i/t.cellSize),a=0;a<=o;a+=1){var s=a*t.cellSize,u=[0,s],l=[i,s];t.view.drawLine(n,a%5,1,r?u.reverse():u,r?l.reverse():l)}}),this.view.drawStrokeRect([0,0],e)}},{key:"drawDots",value:function(){var t=this,e={red:this.view.getColorCode("red",1),blue:this.view.getColorCode("blue",1)},n=this.getDotRadius();this.matrix.getAllDots().forEach(function(r){var i=r.coords,o=r.color;t.view.drawDot(e[o],n,i.map(t.scaleCoord,t)),t.view.drawDotCoords(e[o],n,i.map(t.scaleCoord,t),i)})}},{key:"drawZones",value:function(){var t=this,e=this.getLineWidth(),n=function(n,r,i){t.view.drawLine(n,!1,e,r.coords.map(t.scaleCoord,t),i.coords.map(t.scaleCoord,t))};["red","blue"].forEach(function(e){var r=t.view.getColorCode(e,.6);t.matrix.zones[e].forEach(function(t){for(var e=1;e<t.length;e+=1)n(r,t[e-1],t[e]);n(r,t[t.length-1],t[0])})})}},{key:"scaleCoord",value:function(t){return t*this.cellSize}},{key:"getDotRadius",value:function(){return Math.max(this.cellSize/8,2)}},{key:"getLineWidth",value:function(){return Math.max(this.cellSize/16,2)}},{key:"clearOnKeyDown",value:function(t){t.altKey&&67===t.keyCode&&(this.matrix.reset(),this.nextPlayer="red",this.render(),this.save())}},{key:"zoomOnScroll",value:function(t){if(t.deltaY){var e=this.cellSize*(1-.05*Math.sign(t.deltaY));e>this.minCellSize&&e<this.maxCellSize&&(this.cellSize=e,this.render())}}},{key:"drawDotPlaceholderOnMouseMove",value:function(t){var e=this.getClosestGridLinesIntersection([t.offsetX,t.offsetY]);this.render(),e&&!this.matrix.getDot(e)&&this.view.drawDot(this.view.getColorCode(this.nextPlayer,.6),this.getDotRadius(),e.map(this.scaleCoord,this))}},{key:"placeDotOnClick",value:function(t){var e=this.getClosestGridLinesIntersection([t.offsetX,t.offsetY]);if(e&&!this.matrix.getDot(e)){var n=this.matrix.placeDot(e,this.nextPlayer);this.matrix.addDotToZones(n),this.nextPlayer="red"===this.nextPlayer?"blue":"red",this.render(),this.save()}}},{key:"getClosestGridLinesIntersection",value:function(t){var e=this,n=[];return[0,1].forEach(function(r){var i=t[r]/e.cellSize,o=Math.floor(i),a=Math.ceil(i);i-o<.2?n[r]=o:a-i<.2&&(n[r]=a)}),void 0!==n[0]&&void 0!==n[1]?n:null}}]),t}();e.default=o}],[0]);